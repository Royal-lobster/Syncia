var O=Object.create;var l=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty;var F=(e,s)=>{for(var n in s)l(e,n,{get:s[n],enumerable:!0})},d=(e,s,n,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let o of L(s))!A.call(e,o)&&o!==n&&l(e,o,{get:()=>s[o],enumerable:!(r=W(s,o))||r.enumerable});return e};var x=(e,s,n)=>(n=e!=null?O(V(e)):{},d(s||!e||!e.__esModule?l(n,"default",{value:e,enumerable:!0}):n,e)),P=e=>d(l({},"__esModule",{value:!0}),e);var C={};F(C,{default:()=>k});module.exports=P(C);var w=require("@parcel/plugin"),R=require("@parcel/utils"),N=x(require("assert"));var g=typeof globalThis.process<"u"?globalThis.process.argv:[];var y=()=>typeof globalThis.process<"u"?globalThis.process.env:{};var S=new Set(g),v=e=>S.has(e),q=g.filter(e=>e.startsWith("--")&&e.includes("=")).map(e=>e.split("=")).reduce((e,[s,n])=>(e[s]=n,e),{});var H=v("--dry-run"),m=()=>v("--verbose")||y().VERBOSE==="true",X=m();var D=(e="",...s)=>console.log(e.padEnd(9),"|",...s);var T=0,h=(...e)=>m()&&D(`\u{1F7E1} ${T++}`,...e);var _=x(require("nullthrows"));var E=require("@parcel/utils");function u(e,s){return(0,E.relativeBundlePath)(e,s,{leadingDotSlash:!1})}var M=(e,s,n,r=[])=>r.map(o=>{let c=n.filter(t=>o.js?.includes(t.id)||o.css?.includes(t.id)).map(t=>(0,_.default)(s.getReferencedBundle(t,e)));o.css=[...new Set((o.css||[]).concat(c.flatMap(t=>s.getReferencedBundles(t)).filter(t=>t.type=="css").map(t=>u(e,t))))];let i=c.flatMap(t=>{let a=[],f=s.getReferencedBundles(t);return s.traverseBundles(p=>{t!==p&&!f.includes(p)&&a.push(p)},t),a}).map(t=>u(e,t));return i.length>0?{matches:o.matches.map(t=>{if(/^(((http|ws)s?)|ftp|\*):\/\//.test(t)){let a=t.indexOf("/",t.indexOf("://")+3);return a===-1&&(a=t.length),t.slice(0,a)+"/*"}return t}),resources:i}:null}).filter(Boolean);function B(e,s,n){let r=(e.web_accessible_resources||[]).concat([...new Set(s.flatMap(o=>o.resources))]);r.length>0&&(e.web_accessible_resources=r)}function b(e,s,n){n.hmrOptions&&s.push({matches:["<all_urls>"],resources:["__plasmo_hmr_proxy__"]}),s.length>0&&(e.web_accessible_resources=(e.web_accessible_resources||[]).concat(s))}var k=new w.Packager({async package({bundle:e,bundleGraph:s,options:n}){h("@plasmohq/parcel-packager");let r=[];e.traverseAssets(p=>{r.push(p)});let o=r.filter(p=>p.meta.webextEntry===!0);(0,N.default)(r.length===2&&o.length===1,"Web extension bundles must contain exactly one manifest asset and one runtime asset");let[c]=o,i=JSON.parse(await c.getCode()),t=c.getDependencies(),a=M(e,s,t,i.content_scripts);i.manifest_version===2?B(i,a,n):b(i,a,n);let{contents:f}=(0,R.replaceURLReferences)({bundle:e,bundleGraph:s,contents:JSON.stringify(i)});return{contents:f}}});
